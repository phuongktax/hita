O:8:"stdClass":9:{s:5:"title";s:102:"Series bảo mật nhập môn – Lưu trữ cookie – tưởng hại ai ngờ hại không tưởng";s:4:"link";s:95:"http://techtalk.vn/series-bao-mat-nhap-mon-luu-tru-cookie-tuong-hai-ai-ngo-hai-khong-tuong.html";s:11:"description";s:600:"<div>Cookie l&agrave; m&#7897;t kh&aacute;i ni&#7879;m h&#7871;t s&#7913;c c&#417; b&#7843;n m&agrave; ta &#273;&#432;&#7907;c h&#7885;c khi m&#7899;i l&#7853;p tr&igrave;nh web. Tuy nhi&ecirc;n, n&#7871;u s&#7917; d&#7909;ng kh&ocirc;ng &#273;&uacute;ng c&aacute;ch, n&oacute; s&#7869; th&agrave;nh &ldquo;m&#7891;i ngon&rdquo; cho v&ocirc; s&#7889; hacker. B&agrave;i vi&#7871;t n&agrave;y s&#7869; &#273;&#7873; c&#7853;p &#273;&#7871;n nh&#7919;ng c&aacute;ch hacker m&agrave; c&oacute; th&#7875; l&#7907;i d&#7909;ng cookie &#273;&#7875; chi&#7871;m quy&#7873;n ng&#432;&#7901;i [&hellip;]</div>";s:7:"content";s:11734:"<div><p class="p1"><em><strong><span class="s1">Cookie l&agrave; m&#7897;t kh&aacute;i ni&#7879;m h&#7871;t s&#7913;c c&#417; b&#7843;n m&agrave; ta &#273;&#432;&#7907;c h&#7885;c khi m&#7899;i l&#7853;p tr&igrave;nh web. Tuy nhi&ecirc;n, n&#7871;u s&#7917; d&#7909;ng kh&ocirc;ng &#273;&uacute;ng c&aacute;ch, n&oacute; s&#7869; th&agrave;nh &ldquo;m&#7891;i ngon&rdquo; cho v&ocirc; s&#7889; hacker.</span></strong></em></p>
<p class="p1"><span class="s1">B&agrave;i vi&#7871;t n&agrave;y s&#7869; &#273;&#7873; c&#7853;p &#273;&#7871;n nh&#7919;ng c&aacute;ch hacker m&agrave; c&oacute; th&#7875; l&#7907;i d&#7909;ng cookie &#273;&#7875; chi&#7871;m quy&#7873;n ng&#432;&#7901;i d&ugrave;ng, t&#7845;n c&ocirc;ng h&#7879; th&#7889;ng, c&ugrave;ng v&#7899;i ph&#432;&#417;ng ph&aacute;p s&#7917; d&#7909;ng cookie &#273;&uacute;ng c&aacute;ch &#273;&#7875; ng&#259;n ch&#7863;n nh&#7919;ng l&#7895; h&#7893;ng n&agrave;y nh&eacute;.</span></p>
<p class="p3"><span class="s1">Cookie &ndash; Chi&#7871;c &ldquo;b&aacute;nh qui&rdquo; v&ocirc; h&#7841;i?</span></p>
<p class="p1"><span class="s1">Server v&agrave; client giao ti&#7871;p v&#7899;i nhau th&ocirc;ng qua <a href="https://toidicodedao.com/2016/10/04/bao-mat-cua-giao-thuc-http/"><span class="s2">giao th&#7913;c HTTP</span></a>. &#272;&#7863;c &#273;i&#7875;m c&#7911;a giao th&#7913;c n&agrave;y l&agrave; stateless. Server kh&ocirc;ng th&#7875; bi&#7871;t &#273;&#432;&#7907;c 2 request c&oacute; t&#7899;i t&#7915; c&ugrave;ng 1 client hay kh&ocirc;ng.</span></p>
<p class="p1"><span class="s1">V&igrave; &#273;&#7863;t &#273;i&#7875;m n&agrave;y, cookie ra &#273;&#7901;i. V&#7873; b&#7843;n ch&#7845;t, cookie l&agrave; m&#7897;t file text nh&#7887; &#273;&#432;&#7907;c server g&#7917;i v&#7873; client, sau &#273;&oacute; browser l&#432;u v&agrave;o m&aacute;y ng&#432;&#7901;i d&ugrave;ng. Khi client g&#7917;i request t&#7899;i server, <b>n&oacute; s&#7869; g&#7917;i k&egrave;m cookie</b>. Server d&#7921;a v&agrave;o cookie n&agrave;y &#273;&#7875; nh&#7853;n ra ng&#432;&#7901;i d&ugrave;ng.</span></p>
<p class="p1"><span class="s1">Cookie th&#432;&#7901;ng c&oacute; name, value, domain v&agrave; expiration:</span></p>
<ul class="ul1"><li class="li1"><span class="s1">Name, &#273;i k&egrave;m v&#7899;i value: T&ecirc;n cookie v&agrave; gi&aacute; tr&#7883; c&#7911;a cookie &#273;&oacute;</span></li>
<li class="li1"><span class="s1">Domain: Domain m&agrave; cookie &#273;&#432;&#7907;c g&#7917;i l&ecirc;n. Nh&#432; &#7903; h&igrave;nh d&#432;&#7899;i, cookies ch&#7881; &#273;&#432;&#7907;c g&#7917;i khi client truy c&#7853;p wordpress.com.</span></li>
<li class="li1"><span class="s1">Expiration: Th&#7901;i gian cookie t&#7891;n t&#7841;i &#7903; m&aacute;y client. Qu&aacute; th&#7901;i gian n&agrave;y, cookie s&#7869; b&#7883; xo&aacute;.</span></li>
</ul><p class="p3"><img class="aligncenter size-full wp-image-11045" src="http://static.techtalk.vn/wp-content/uploads/2016/10/screen-shot-2016-10-08-at-6-08-24-pm.png" alt="screen-shot-2016-10-08-at-6-08-24-pm" width="474" height="258" srcset="http://static.techtalk.vn/wp-content/uploads/2016/10/screen-shot-2016-10-08-at-6-08-24-pm.png 474w, http://static.techtalk.vn/wp-content/uploads/2016/10/screen-shot-2016-10-08-at-6-08-24-pm-300x163.png 300w" sizes="(max-width: 474px) 100vw, 474px"></p>
<p class="p3"><span class="s1">B&aacute;nh qui nho nh&#7887;, &#273;&#7847;y nh&#7919;ng l&#7895; to to</span></p>
<p class="p1"><span class="s1">Sau khi t&igrave;m hi&#7875;u c&#417; b&#7843;n v&#7873; cookie, ta s&#7869; t&igrave;m hi&#7875;u nh&#7919;ng l&#7895;i b&#7843;o m&#7853;t m&agrave; cookie c&oacute; th&#7875; g&acirc;y ra nh&eacute;.</span></p>
<p class="p1"><span class="s1">Nh&#432; m&igrave;nh &#273;&atilde; n&oacute;i, cookie &#273;&#432;&#7907;c g&#7917;i k&egrave;m theo m&#7895;i request l&ecirc;n server. Server d&#7921;a theo cookie &#273;&#7875; nh&#7853;n d&#7841;ng ng&#432;&#7901;i d&ugrave;ng. Do &#273;&oacute;, n&#7871;u c&oacute; th&#7875; &ldquo;ch&ocirc;m cookie&rdquo; c&#7911;a ng&#432;&#7901;i kh&aacute;c, ta c&oacute; th&#7875; m&#7841;o danh ng&#432;&#7901;i &#273;&oacute;.</span></p>
<p class="p1"><span class="s1">Cookie c&oacute; th&#7875; b&#7883; ch&ocirc;m theo c&aacute;c con &#273;&#432;&#7901;ng sau:</span></p>
<ul class="ul1"><li class="li1"><span class="s1">Sniff cookie qua m&#7841;ng: S&#7917; d&#7909;ng 1 s&#7889; tool &#273;&#417;n gi&#7843;n &#273;&#7875; sniff nh&#432; Fiddler, Wireshark, ta c&oacute; th&#7875; ch&ocirc;m cookie c&#7911;a ng&#432;&#7901;i d&ugrave;ng &#7903; c&ugrave;ng m&#7841;ng. Sau &#273;&oacute;, s&#7917; d&#7909;ng <b>EditThisCookie</b> &#273;&#7875; dump cookie n&agrave;y v&agrave;o tr&igrave;nh duy&#7879;t &#273;&#7875; m&#7841;o danh ng&#432;&#7901;i d&ugrave;ng. (Xem demo <a href="https://toidicodedao.com/2016/10/04/bao-mat-cua-giao-thuc-http/"><span class="s2">b&agrave;i HTTP</span></a>).</span></li>
<li class="li1"><span class="s1">Ch&ocirc;m cookie (Cookie thief) b&#7857;ng XSS: V&#7899;i l&#7895; h&#7895;ng XSS, hacker c&oacute; th&#7875; ch&#7841;y m&atilde; &#273;&#7897;c (JavaScript) &#7903; ph&iacute;a ng&#432;&#7901;i d&ugrave;ng. JS c&oacute; th&#7875; &#273;&#7885;c gi&aacute; tr&#7883; t&#7915; cookie v&#7899;i h&agrave;m <i>document.cookie</i>. Hacker c&oacute; th&#7875; g&#7917;i cookie n&agrave;y t&#7899;i server c&#7911;a m&igrave;nh. Cookie n&agrave;y s&#7869; &#273;&#432;&#7907;c d&ugrave;ng &#273;&#7875; m&#7841;o danh ng&#432;&#7901;i d&ugrave;ng.</span></li>
</ul><ul class="ul1"><li class="li1"><span class="s1">Th&#7921;c hi&#7879;n t&#7845;n c&ocirc;ng ki&#7875;u CRSF (Cross-site request forgery). Hacker c&oacute; th&#7875; post m&#7897;t link &#7843;nh nh&#432; sau:</span></li>
</ul><p></p><pre class="crayon-plain-tag">&lt;img src="http://bank.example.com/withdraw?account=bob&amp;amount=1000000&amp;for=mallory"&gt;</pre><p></p>
<p class="p8">
</p><ul class="ul1"><li class="li1"><span class="s1">Tr&igrave;nh duy&#7879;t s&#7869; t&#7921; &#273;&#7897;ng load link trong &#7843;nh, d&#297; nhi&ecirc;n l&agrave; <b>c&oacute; k&egrave;m theo cookie</b>. &#272;&#432;&#7901;ng link trong &#7843;nh s&#7869; &#273;&#7885;c cookie t&#7915; request, x&aacute;c nh&#7853;n ng&#432;&#7901;i d&ugrave;ng, r&uacute;t s&#7841;ch ti&#7873;n m&agrave; ng&#432;&#7901;i d&ugrave;ng kh&ocirc;ng h&#7873; hay bi&#7871;t. C&aacute;ch t&#7845;n c&ocirc;ng n&agrave;y c&oacute; r&#7845;t nhi&#7873;u bi&#7871;n th&#7875;, m&igrave;nh s&#7869; n&oacute;i r&otilde; &#7903; b&agrave;i vi&#7871;t sau.</span></li>
</ul><h3 class="p3"><strong><span class="s1">C&aacute;ch ph&ograve;ng ch&#7889;ng</span></strong></h3>
<p class="p1"><span class="s1">Xin nh&#7855;c l&#7841;i l&#7847;n th&#7913; n, c&aacute;c b&#7841;n h&#7885;c c&aacute;ch t&#7845;n c&ocirc;ng Website &#273;&#7875; bi&#7871;t m&agrave; ph&ograve;ng ch&#7889;ng ch&#7913; kh&ocirc;ng n&ecirc;n d&ugrave;ng &#273;&#7875; &#273;i hack ph&aacute; l&agrave;ng ph&aacute; x&oacute;m nh&eacute;. N&#7871;u g&#7863;p l&#7895; h&#7893;ng b&#7843;o m&#7853;t &#7903; trang web n&agrave;o kh&aacute;c, vui l&ograve;ng g&#7917;i mail th&ocirc;ng b&aacute;o cho admin &#273;&#7875; h&#7885; s&#7917;a ch&#7919;a ch&#7913; &#273;&#7915;ng hack r&#7891;i <a href="https://toidicodedao.com/2015/11/05/khai-truong-trang-fanpage-cua-toi-di-code-dao-mung-blog-dat-moc-100k-view/"><span class="s2">khoe Facebook</span></a> nh&eacute;.</span></p>
<p class="p1"><span class="s1">Ph&#7847;n n&agrave;y c&#7911;a b&agrave;i vi&#7871;t s&#7869; h&#432;&#7899;ng d&#7851;n c&aacute;c b&#7841;n c&aacute;ch s&#7917; d&#7909;ng cookie &#273;&uacute;ng c&aacute;ch &#273;&#7875; tr&aacute;nh nh&#7919;ng l&#7895;i b&#7843;o m&#7853;t kh&ocirc;ng &#273;&aacute;ng c&oacute;.</span></p>
<ul class="ul1"><li class="li1"><span class="s1">Nh&#7899; set <b>Expired v&agrave; Max-Age</b>: &#272;&#7875; gi&#7843;m thi&#7875;u thi&#7879;t h&#7841;i khi cookie b&#7883; tr&#7897;m, ta kh&ocirc;ng n&ecirc;n &#273;&#7875; cookie s&#7889;ng qu&aacute; l&acirc;u. N&ecirc;n set th&#7901;i gian s&#7889;ng c&#7911;a cookie trong kho&#7843;ng 1 ng&agrave;y t&#7899;i 3 th&aacute;ng, tu&#7923; theo y&ecirc;u c&#7847;u c&#7911;a application.</span></li>
<li class="li1"><span class="s1">S&#7917; d&#7909;ng Flag <b>HTTP Only</b>: Cookie c&oacute; flag n&agrave;y s&#7869; kh&ocirc;ng th&#7875; truy c&#7853;p th&ocirc;ng qua h&agrave;m <i>document.cookie</i>. Do &#273;&oacute;, d&ugrave; web c&oacute; b&#7883; l&#7895;i XSS th&igrave; hacker kh&ocirc;ng th&#7875; &#273;&aacute;nh c&#7855;p &#273;&#432;&#7907;c n&oacute;.</span></li>
<li class="li1"><span class="s1">S&#7917; d&#7909;ng Flag <b>Secure</b>: Cookie c&oacute; flag n&agrave;y <b>ch&#7881; &#273;&#432;&#7907;c g&#7917;i qua giao th&#7913;c HTTPS</b>, hacker s&#7869; kh&ocirc;ng th&#7875; sniff &#273;&#432;&#7907;c.</span></li>
<li class="li1"><span class="s1">V&igrave; cookie d&#7877; b&#7883; t&#7845;n c&ocirc;ng, tuy&#7879;t &#273;&#7889;i <b>kh&ocirc;ng ch&#7913;a nh&#7919;ng th&ocirc;ng tin quan tr&#7885;ng </b>trong cookie (M&#7853;t kh&#7849;u, s&#7889; t&agrave;i kho&#7843;n, &hellip;). N&#7871;u b&#7855;t bu&#7897;c ph&#7843;i l&#432;u th&igrave; c&#7847;n m&atilde; ho&aacute; c&#7849;n th&#7853;n.</span></li>
</ul><p class="p1"><img class="aligncenter size-full wp-image-11046" src="http://static.techtalk.vn/wp-content/uploads/2016/10/photo-1438354886727-070458b3b5cf.jpg" alt="photo-1438354886727-070458b3b5cf" width="412" height="320" srcset="http://static.techtalk.vn/wp-content/uploads/2016/10/photo-1438354886727-070458b3b5cf.jpg 412w, http://static.techtalk.vn/wp-content/uploads/2016/10/photo-1438354886727-070458b3b5cf-300x233.jpg 300w" sizes="(max-width: 412px) 100vw, 412px"></p>
<p class="p1"><span class="s1">Note th&ecirc;m: N&#7871;u website c&#7911;a b&#7841;n s&#7917; d&#7909;ng RESTful API, <b>&#273;&#7915;ng s&#7917; d&#7909;ng cookie</b> &#273;&#7875; authorize ng&#432;&#7901;i d&ugrave;ng m&agrave; h&atilde;y <b>d&ugrave;ng OAuth ho&#7863;c WebToken</b>. Token n&agrave;y &#273;&#432;&#7907;c v&agrave;o Header c&#7911;a m&#7895;i request n&ecirc;n s&#7869; kh&ocirc;ng b&#7883; d&iacute;nh l&#7895;i CRSF nh&eacute;.</span></p>
<p class="p1"><span class="s1">C&aacute;c b&#7841;n c&oacute; th&#7875; t&igrave;m hi&#7875;u th&ecirc;m v&#7873; cookie v&agrave; c&aacute;c l&#7895;i b&#7843;o m&#7853;t li&ecirc;n quan &#7903; &#273;&acirc;y:</span></p>
<ul class="ul1"><li class="li10"><span class="s9"><a href="http://resources.infosecinstitute.com/securing-cookies-httponly-secure-flags/"><span class="s10">http://resources.infosecinstitute.com/securing-cookies-httponly-secure-flags/</span></a></span></li>
<li class="li10"><span class="s9"><a href="http://www.ibm.com/support/knowledgecenter/SSZLC2_7.0.0/com.ibm.commerce.admin.doc/concepts/csesmsession_mgmt.htm"><span class="s10">http://www.ibm.com/support/knowledgecenter/SSZLC2_7.0.0/com.ibm.commerce.admin.doc/concepts/csesmsession_mgmt.htm</span></a></span></li>
<li class="li10"><span class="s9"><a href="https://www.nczonline.net/blog/2009/05/05/http-cookies-explained/"><span class="s10">https://www.nczonline.net/blog/2009/05/05/http-cookies-explained/</span></a></span></li>
<li class="li10"><span class="s9"><a href="https://en.wikipedia.org/wiki/HTTP_cookie#Secure_and_HttpOnly"><span class="s10">https://en.wikipedia.org/wiki/HTTP_cookie#Secure_and_HttpOnly</span></a></span></li>
<li class="li10"><span class="s9"><a href="http://programmers.stackexchange.com/questions/298973/rest-api-security-stored-token-vs-jwt-vs-oauth"><span class="s10">http://programmers.stackexchange.com/questions/298973/rest-api-security-stored-token-vs-jwt-vs-oauth</span></a></span></li>
</ul></div>";s:6:"author";O:16:"SimplePie_Author":3:{s:4:"name";s:7:"Hieu Le";s:4:"link";N;s:5:"email";N;}s:4:"date";s:19:"2016-10-25 01:00:53";s:10:"enclosures";a:1:{i:0;O:19:"SimplePie_Enclosure":27:{s:7:"bitrate";N;s:8:"captions";N;s:10:"categories";N;s:8:"channels";N;s:9:"copyright";N;s:7:"credits";N;s:11:"description";N;s:8:"duration";N;s:10:"expression";N;s:9:"framerate";N;s:7:"handler";N;s:6:"hashes";N;s:6:"height";N;s:10:"javascript";N;s:8:"keywords";N;s:4:"lang";N;s:6:"length";N;s:4:"link";N;s:6:"medium";N;s:6:"player";N;s:7:"ratings";N;s:12:"restrictions";a:1:{i:0;O:21:"SimplePie_Restriction":3:{s:12:"relationship";s:5:"allow";s:4:"type";N;s:5:"value";s:7:"default";}}s:12:"samplingrate";N;s:10:"thumbnails";N;s:5:"title";N;s:4:"type";N;s:5:"width";N;}}s:7:"src_url";s:95:"http://techtalk.vn/series-bao-mat-nhap-mon-luu-tru-cookie-tuong-hai-ai-ngo-hai-khong-tuong.html";s:8:"src_name";s:54:"Series bảo mật nhập môn – Lưu trữ cook ...";}